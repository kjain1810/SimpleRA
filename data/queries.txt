LOAD EMPLOYEE
LOAD WORKS_ON
LOAD PROJECT

TMP1 <- PROJECT Ssn,Salary FROM EMPLOYEE
Q1 <- SELECT Salary >= 30000 FROM TMP1
EXPORT Q1

TMP2 <- CROSS EMPLOYEE, EMPLOYEE
TMP3 <- SELECT EMPLOYEE1_Super_ssn == EMPLOYEE2_Ssn FROM TMP2
TMP4 <- PROJECT EMPLOYEE1_Ssn,EMPLOYEE2_Ssn,EMPLOYEE1_Bdate,EMPLOYEE2_Bdate FROM TMP3
TMP5 <- SELECT EMPLOYEE1_Bdate == EMPLOYEE2_Bdate FROM TMP4
Q2 <- PROJECT EMPLOYEE1_Ssn,EMPLOYEE2_Ssn,EMPLOYEE1_Bdate FROM TMP5
RENAME EMPLOYEE1_Ssn TO Ssn FROM Q2
RENAME EMPLOYEE2_Ssn TO Super_ssn FROM Q2
RENAME EMPLOYEE1_Bdate TO Bdate FROM Q2
EXPORT Q2

PROJ_ESSN <- PROJECT Essn,Pno FROM WORKS_ON
SSN_SEX <- PROJECT Ssn,Sex FROM EMPLOYEE
ALL_CROSS <- CROSS PROJ_ESSN SSN_SEX
SSN_SEX_PROJ <- SELECT Ssn == Essn FROM ALL_CROSS
PROJ_SEX <- PROJECT Pno,Sex FROM SSN_SEX_PROJ
PROJ_SEX_2 <- CROSS PROJ_SEX PROJ_SEX
PROJ_SEX_PAIR <- SELECT PROJ_SEX1_Pno == PROJ_SEX2_Pno FROM PROJ_SEX_2
DIFFERENT_SEX <- SELECT PROJ_SEX1_Sex != PROJ_SEX2_Sex FROM PROJ_SEX_PAIR
Q3 <- PROJECT PROJ_SEX1_Pno FROM DIFFERENT_SEX
RENAME PROJ_SEX1_Pno TO Pno FROM Q3
EXPORT Q3

SSN_SUP <- PROJECT Ssn,Super_ssn FROM EMPLOYEE
ESSN_PNO <- PROJECT Essn,Pno FROM WORKS_ON
ALL_CROSS <- CROSS SSN_SUP ESSN_PNO
SSN_SUP_PNO <- SELECT Ssn == Essn FROM ALL_CROSS
SSN_SUP_PNO2 <- PROJECT Ssn,Super_ssn,Pno FROM SSN_SUP_PNO
ALL_CROSS2 <- CROSS SSN_SUP_PNO2 SSN_SUP_PNO2
SSN_SUP_EPNO_SPNO <- SELECT SSN_SUP_PNO21_Ssn == SSN_SUP_PNO22_Super_ssn FROM ALL_CROSS2
LMAO <- SELECT SSN_SUP_PNO21_Pno == SSN_SUP_PNO22_Pno FROM SSN_SUP_EPNO_SPNO
Q4 <- PROJECT SSN_SUP_PNO22_Ssn,SSN_SUP_PNO21_Ssn,SSN_SUP_PNO22_Pno FROM LMAO
RENAME SSN_SUP_PNO22_Ssn TO Ssn FROM Q4
RENAME SSN_SUP_PNO21_Ssn TO Super_ssn FROM Q4
RENAME SSN_SUP_PNO22_Pno TO Pno FROM Q4
EXPORT Q4

P1 <- SELECT Dnum <= 5 FROM PROJECT
P2 <- SELECT Dnum >= 1 FROM PROJECT
P3 <- SELECT Dnum != 2 FROM PROJECT
P4 <- SELECT Dnum != 3 FROM PROJECT
Q5 <- SELECT Dnum != 4 FROM PROJECT
EXPORT Q5
